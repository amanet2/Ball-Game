getres isv setnstate $1 virus
# fix a bug with virus mode
testres $isv null setnstate $1 virus 0
testres $isv null setvar isv 0
testres $isv 0 givepoint $1
testres $isv 0 setvar allvirus 0
testresn $isv 0 exec scripts/createviruspopup $1
testres $isv 0 getres cw setthing THING_PLAYER $1 weapon
testres $isv 0 testresn $cw 2 exec scripts/giveweapon $1 $weap_shotgun